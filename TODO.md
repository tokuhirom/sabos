# SABOS 夢いっぱい TODO リスト 🚀

セキュリティと型安全性を重視した、夢の自作 OS への道のり。

## 🎯 短期目標（そろそろやりたい）

### IPC 基盤
- [ ] 型安全なメッセージパッシング
  - Rust の型システムを活かしたプロセス間通信
  - シリアライズ/デシリアライズなしで構造体を直接渡せる仕組み
  - 不正なメッセージはコンパイル時に弾く
- [ ] Capability ベースのセキュリティモデル
  - ファイルハンドルを「権限トークン」として扱う
  - 権限の委譲・制限を型で表現

### ファイルシステムのユーザー空間移行
- [ ] FAT16 ドライバをユーザー空間で動かす
- [ ] VFS (Virtual File System) 層の設計
- [ ] ファイルシステムがクラッシュしてもカーネルは生き残る
- [ ] procfs をユーザー空間サービス化

### ネットワークスタックのユーザー空間移行
- [ ] TCP/IP スタックをユーザー空間サービス化
- [ ] ネットワークドライバの分離
- [ ] バグがあってもカーネルパニックしない

## 🌟 中期目標（いつかやりたい）

### セキュリティ強化
- [ ] ASLR (Address Space Layout Randomization)
  - プロセスのメモリ配置をランダム化
  - 攻撃者がアドレスを推測できなくする
- [ ] W^X (Write XOR Execute)
  - メモリページは「書き込み可能」か「実行可能」のどちらか一方のみ
  - コード注入攻撃を防ぐ
- [ ] スタックカナリア
  - バッファオーバーフローを検出
- [ ] KASLR (Kernel ASLR)
  - カーネル自体のアドレスもランダム化

### Capability ベース OS への進化
- [ ] 全リソースを Capability で管理
  - ファイル、ネットワーク、デバイス、メモリ全てが権限トークン
  - 「何でもできる root」を廃止
- [ ] 最小権限の原則を強制
  - プロセスは必要な権限だけを持つ
  - 権限エスカレーション攻撃を構造的に防ぐ
- [ ] Capability の型安全な受け渡し
  - IPC で権限を安全に委譲

### 形式検証への挑戦
- [ ] カーネルの重要部分を Kani/Prusti で検証
  - メモリ管理の安全性
  - スケジューラの公平性
  - IPC のデッドロックフリー
- [ ] 契約プログラミング
  - 事前条件・事後条件・不変条件を明示

### 高度なメモリ管理
- [ ] Copy-on-Write (CoW) fork
  - fork 時にメモリをコピーせず、書き込み時に初めてコピー
- [ ] Demand Paging
  - ページを必要になるまで確保しない
- [ ] メモリマップドファイル (mmap)
  - ファイルをメモリとしてアクセス
- [ ] Huge Pages サポート
  - 2MB/1GB ページで TLB ミスを削減

## 🌈 長期目標（夢）

### GUI サブシステム
- [ ] フレームバッファベースのウィンドウシステム
- [ ] 最小限のウィンドウマネージャ
- [ ] マウスドライバ（USB HID または PS/2）
- [ ] 簡単な GUI ツールキット
- [ ] ターミナルエミュレータ
- [ ] 画像ビューア

### ネットワーク機能拡張
- [ ] DHCP クライアント
  - IP アドレスの自動取得
- [ ] HTTPS (TLS 1.3)
  - 暗号化通信
  - 証明書検証
- [ ] SSH サーバー/クライアント
  - セキュアなリモートアクセス
- [ ] NTP クライアント
  - 時刻同期

### ファイルシステム拡張
- [ ] ext2/ext4 サポート
- [ ] ジャーナリング
  - クラッシュ時のデータ保護
- [ ] 暗号化ファイルシステム
  - ディスク全体を暗号化
- [ ] FUSE 的なユーザー空間 FS インターフェース

### ハードウェアサポート拡張
- [ ] AHCI (SATA) ドライバ
  - 実機の SSD/HDD にアクセス
- [ ] NVMe ドライバ
  - 高速 SSD
- [ ] USB 3.0 (xHCI)
  - キーボード、マウス、ストレージ
- [ ] Intel HD Audio
  - 音を鳴らす！
- [ ] GPU ドライバ（基本的な 2D アクセラレーション）

### マルチコア対応
- [ ] SMP (Symmetric Multi-Processing)
  - 複数 CPU コアを活用
- [ ] Per-CPU データ構造
- [ ] ロックフリーデータ構造
- [ ] コア間 IPI (Inter-Processor Interrupt)

### セルフホスティング
- [ ] SABOS 上で Rust コンパイラを動かす
- [ ] SABOS 上で SABOS をビルドする
- [ ] 自分自身をコンパイルできる OS になる！

## 🎮 お楽しみ機能

### ゲーム
- [ ] テトリス
- [ ] スネークゲーム
- [ ] Doom（移植）
- [ ] シンプルな 2D ゲームエンジン

### デモ
- [ ] 起動時のアニメーション
- [ ] アスキーアート表示
- [ ] 3D ワイヤーフレーム回転（ソフトウェアレンダリング）

### 開発者ツール
- [ ] カーネルデバッガ
- [ ] システムモニター（top 的なもの）
- [ ] ファイルマネージャ
- [ ] テキストエディタ（ed/vi 的なもの）

## 🔬 研究的な挑戦

### 言語統合
- [ ] カーネルとユーザー空間で同じ型定義を共有
- [ ] システムコールの型を自動生成
- [ ] コンパイル時に権限チェック

### 新しいセキュリティモデル
- [ ] 情報フロー制御
  - 機密データがどこに流れるか追跡
- [ ] サンドボックス
  - 信頼できないコードを隔離実行
- [ ] Secure Enclave 的な機能
  - 機密処理を分離

### 分散システム
- [ ] 複数マシンでの透過的なプロセス移動
- [ ] 分散ファイルシステム
- [ ] クラスタ上での並列計算

---

## 📝 完了した項目

- [x] UEFI ブート
- [x] フレームバッファ描画
- [x] キーボード入力
- [x] ページング・仮想メモリ
- [x] ヒープアロケータ
- [x] 協調的マルチタスク
- [x] プリエンプティブマルチタスク
- [x] ユーザーモード (Ring 3)
- [x] プロセス分離（独立アドレス空間）
- [x] ELF ローダー
- [x] virtio-blk ドライバ
- [x] FAT16 ファイルシステム（読み書き）
- [x] virtio-net ドライバ
- [x] ARP / ICMP
- [x] UDP / DNS クライアント
- [x] TCP クライアント / HTTP GET
- [x] ユーザー空間シェル（17 コマンド）
- [x] 型安全なシステムコール境界 (UserSlice<T>)
- [x] 自動テストフレームワーク (selftest)

---

*「完璧を目指すより、まず動くものを作る。動いたら少しずつ良くする。」*

*楽しんで作ろう！* 🎉
