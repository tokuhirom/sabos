# コンソール簡易テキストエディタ仕様 (ed 風)

## 目的

- GUI ではなくコンソールで動く最小限のテキストエディタを作る
- ユーザーシェルの入力/出力だけで完結させる
- 将来的にフルスクリーン型へ拡張するための土台を作る

## 非目標

- カーソル移動や画面全体の再描画は行わない
- 正規表現検索や高度な置換は行わない
- 複数ファイルの同時編集は行わない

## 想定バイナリ

- `/ED.ELF`

## 起動方法

- `run /ED.ELF <file>`
- 引数なしの場合は空バッファで開始する

## モード

- **コマンドモード**: 1 行ずつコマンドを入力する
- **入力モード**: `a`/`i` の後に複数行を入力する
  - `.` の単独行で入力終了

## 基本コマンド

- `p` : 全行を表示する
- `n` : 行番号付きで全行を表示する
- `a` : 最終行の後に追記（入力モード）
- `i <N>` : 行番号 N の前に挿入（入力モード）
- `d <N>` : 行番号 N の行を削除
- `w` : ファイルに保存
- `q` : 終了（未保存でも終了）
- `wq` : 保存して終了

## 行番号の扱い

- 行番号は 1 始まり
- 何もない場合は 0 行

## 入出力

- 文字列は UTF-8 として扱う
- 入力は 1 行ずつ読み取る（最大長はシェルと同等の 256 文字）

## ファイル操作

- 既存ファイルがある場合は読み込んでバッファに展開する
- `w` は現在のバッファ全体を保存する
- 書き込みは FAT32 の `create_file` を使い、全体を上書きする

## エラーメッセージ

- 不正なコマンドや範囲外の行番号はエラーを表示する
- ファイルが読めない/書けない場合は理由を表示する

## 拡張の候補

- `s/old/new/` による簡易置換
- `u` による直前操作の undo
- `r <file>` で別ファイルを読み込み追加
- `set wrap on/off` で表示の折り返し制御
